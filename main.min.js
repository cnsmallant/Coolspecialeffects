var Icon=function(e){function t(t){e.call(this),this.flag=0,this.flag=t,this.createView()}__extends(t,e);var i=(__define,t),n=i.prototype;return n.createView=function(){var e=this.createBitmapByName(this.flag+"_png");this.addChild(e)},n.flagadd=function(){this.flag++,this.flag>11&&(this.flag=0)},n.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t},t}(egret.Sprite);egret.registerClass(Icon,"Icon");var LoadingUI=function(e){function t(){e.call(this),this.createView()}__extends(t,e);var i=(__define,t),n=i.prototype;return n.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.width=480,this.textField.height=100,this.textField.textAlign="center",this.textField.x=960-this.textField.width,this.textField.y=490-this.textField.height},n.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(e){function t(){e.call(this),this.iconArr=new Array,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(t,e);var i=(__define,t),n=i.prototype;return n.onAddToStage=function(e){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},n.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},n.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},n.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},n.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},n.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},n.createGameScene=function(){this.sky=this.createBitmapByName("index_body_p3_bg_png"),this.addChild(this.sky);var e=1920,t=e/this.sky.width;this.sky.width=e,this.sky.height=this.sky.height*t,this.iconContainer=new egret.Sprite,this.addChild(this.iconContainer),this.iconContainer.graphics.beginFill(0,0),this.iconContainer.graphics.drawRect(0,0,e,this.sky.height),this.iconContainer.graphics.endFill(),this.iconContainer.anchorOffsetX=this.iconContainer.width/2,this.iconContainer.anchorOffsetY=this.iconContainer.height/2,this.iconContainer.x=e/2,this.iconContainer.y=this.sky.height/2,this.icon=this.createBitmapByName("mid_img_png"),this.addChild(this.icon),this.icon.anchorOffsetX=this.icon.width/2,this.icon.anchorOffsetY=this.icon.height/2,this.icon.scaleX=105/217,this.icon.scaleY=105/217,this.icon.alpha=0,this.icon.x=this.getPosByIndex(4,1e3).x+100*Math.random(),this.icon.y=this.getPosByIndex(4,600).y+100*Math.random();var i=egret.Tween.get(this.icon);i.to({x:this.sky.width/2,y:this.sky.height/2},1e3),this.iconArr=new Array;for(var n=1;12>=n;n++){var o=new Icon(n);this.iconContainer.addChild(o),this.iconArr.push(o),o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,o.x=this.getPosByIndex(n,1e3*Math.random()).x,o.y=this.getPosByIndex(n,600*Math.random()).y;var s=egret.Tween.get(o),r=(this.getPosByIndex(n-1),200*Math.random());s.wait(r).to({x:this.sky.width/2,y:this.sky.height/2},1e3)}var h=egret.Tween.get(this.icon);h.to({alpha:1},2e3),egret.setTimeout(this.showMain,this,2e3)},n.showMain=function(){var e=egret.Tween.get(this.icon);e.to({scaleX:1,scaleY:1},1e3);var t;egret.Tween.get(this.iconContainer);for(t=0;t<this.iconArr.length;t++){var i=egret.Tween.get(this.iconArr[t]);i.to({x:this.getPosByIndex(t).x,y:this.getPosByIndex(t).y},1e3)}egret.setTimeout(this.startAnimation,this,1e3)},n.getPosByIndex=function(e,t,i){void 0===t&&(t=180),void 0===i&&(i=30);var n=new egret.Point;return n.x=960+t*Math.cos(i/180*Math.PI*e),n.y=490+t*Math.sin(i/180*Math.PI*e),egret.log(n.x,n.y),n},n.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t},n.startAnimation=function(){this.iconContainer.rotation=0;for(var e=0;e<this.iconArr.length;e++)this.iconArr[e].rotation=0;var t=egret.Tween.get(this.iconContainer);t.to({rotation:360},36e3);for(var e=0;e<this.iconArr.length;e++){var i=egret.Tween.get(this.iconArr[e]);i.to({rotation:-360},36e3)}egret.setTimeout(this.startAnimation,this,36e3)},t}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");